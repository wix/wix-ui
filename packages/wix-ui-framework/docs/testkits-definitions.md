# Testkit Definitions

by default, when `wuf export-testkits` is executed, it looks for two files:
1. `.wuf/components.json`
2. `.wuf/testkits/definitions.js`

This document describes `.wuf/testkits/definitions.js`.

---

`.wuf/testkits/definitions.js` is a file of the following shape:

```js
module.exports = {
  Component: {
    property: 'value'
  }
}
```

the `property: 'value'` part is arbitrary. It can be anything, whatever is required.
This data can be used in the testkit exports template file.

# Example

let's say we run `wuf export-testkits` like this:

```
wuf export-testkits \
  --components .wuf/components.json \
  --definitions .wuf/testkits/definitions.js \
  --template .wuf/testkits/testkits.template.ejs \
  --output src/testkit/index.ts
```

### `.wuf/components.json`

this file is generated by `wuf update` and is required for `wuf export-testkits`

```js
{
  MyComponent: {
    path: "src/components/MyComponent"
  },
  YourComponent: {
    path: "src/components/YourComponent"
  },
}
```

### `.wuf/testkits/definitions.js`

this file is not required but can be used as configuration for individual testkits

```js
module.exports = {
  MyComponent: {
    unidriver: true,
    testkitPath: 'a/special/path'
  }
}
```

### `.wuf/testkits/testkit.template.ejs`

this is where `components.json` and `definitions.js` come together.

this file uses ejs format allowing to embed javascript (https://github.com/mde/ejs).

it has global variables provided by `wuf`:

- `components`: an array of components. In this example it would be:
  ```js
  [
    {
      name: "MyComponent",
      path: 'src/components/MyComponent',
      unidriver: true,
      testkitPath: 'a/special/path'
    },

    {
      name: 'YourComponent',
      path: 'src/components/YourComponent',
    }
  ]
  ```

- `utils`: utility functions that might be helpful in the template

---

example content of `.wuf/testkits/testkit.template.ejs`:

```
import {
  testkitFactoryCreator,
  uniTestkitFactoryCreator,
} from 'wix-ui-test-utils/vanilla';

<% components.map(component => {
  const camelName = utils.toCamel(component.name);
  const driverFactory = camelName + 'DriverFactory';
  const driverPath = component.testkitPath || [
    '../components',
    component.name,
    component.name + '.driver',
  ].join('\/');

  const testkitName = camelName + 'TestkitFactory';
  const factoryName = component.unidriver ? 'uniTestkitFactoryCreator' : 'testkitFactoryCreator';
%>
import { <%= driverFactory %> } from '<%= driverPath %>';
export const <%= testkitName %> = <%= factoryName%>(<%= driverFactory %>);
<% }) %>
```

---

the output would be such file:

```js
import {
  testkitFactoryCreator,
  uniTestkitFactoryCreator,
} from 'wix-ui-test-utils/vanilla';

import { myComponentDriverFactory } from 'a/special/path';
export const myComponentTestkitFactory = uniTestkitFactoryCreator(myComponentDriverFactory)

import { yourComponentDriverFactory } from 'src/components/YourComponent/YourComponent.driver';
export const yourComponentTestkitFactory = testkitFactoryCreator(yourComponentDriverFactory)
```
